<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Planning interactif RNDV - Roadmap de projet">
    <title>Roadmap billetterie Com√©die-Fran√ßaise - RNDV</title>

    <!-- ============================================
         RNDV Roadmap - Interactive Gantt Chart
         Version: 2.0.0

         Structure:
         1. CSS Variables & Reset
         2. Layout Components
         3. Timeline & Gantt
         4. Tasks & Milestones
         5. UI Components (Modal, Tooltip)
         6. Utilities & States
         ============================================ -->

    <style>
        /* ===========================================
           1. CSS VARIABLES & RESET
           =========================================== */

        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap');

        :root {
            /* Brand Colors */
            --rndv-primary: #4630EA;
            --rndv-primary-light: #6B5AED;
            --rndv-primary-dark: #3425B8;

            /* Neutral Colors */
            --rndv-black: #000000;
            --rndv-white: #FFFFFF;
            --rndv-gray-50: #F8F9FA;
            --rndv-gray-100: #F1F3F4;
            --rndv-gray-200: #E8EAED;
            --rndv-gray-300: #DADCE0;
            --rndv-gray-600: #5F6368;

            /* Status Colors */
            --rndv-green: #00D9A5;
            --rndv-green-light: #E6FBF5;
            --rndv-red: #EA4335;
            --rndv-red-light: #FCE8E6;
            --rndv-yellow: #FBBC04;
            --rndv-yellow-light: #FEF7E0;

            /* Layout */
            --category-width: 140px;
            --month-width: 100px;
            --row-height: 160px;
            --header-height: 40px;

            /* Typography */
            --font-family: 'Rubik', -apple-system, BlinkMacSystemFont, sans-serif;

            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.15);
            --shadow-primary: 0 4px 12px rgba(70, 48, 234, 0.3);

            /* Transitions */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.2s ease;
        }

        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            font-size: 14px;
            color: var(--rndv-black);
            background: var(--rndv-gray-100);
            padding: 40px;
            line-height: 1.5;
        }

        /* ===========================================
           2. LAYOUT COMPONENTS
           =========================================== */

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: var(--rndv-white);
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(70, 48, 234, 0.08), var(--shadow-sm);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 40px;
            background: var(--rndv-primary);
            color: var(--rndv-white);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-img {
            height: 40px;
            filter: brightness(0) invert(1);
        }

        .header-title {
            font-size: 18px;
            font-weight: 400;
            padding-left: 16px;
            border-left: 2px solid rgba(255,255,255,0.3);
            margin-left: 8px;
            opacity: 0.9;
        }

        /* Toolbar */
        .toolbar {
            display: flex;
            gap: 12px;
            padding: 16px 40px;
            background: var(--rndv-white);
            border-bottom: 1px solid var(--rndv-gray-200);
            align-items: center;
            justify-content: flex-end;
        }

        /* ===========================================
           3. TIMELINE & GANTT
           =========================================== */

        .timeline-container {
            display: flex;
            overflow-x: auto;
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }

        /* Categories Sidebar */
        .categories {
            width: var(--category-width);
            min-width: var(--category-width);
            border-right: 1px solid var(--rndv-gray-200);
            background: var(--rndv-gray-50);
            flex-shrink: 0;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid var(--rndv-gray-200);
            background: var(--rndv-gray-50);
        }

        .category {
            height: var(--row-height);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            text-align: center;
            font-weight: 500;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            color: var(--rndv-gray-600);
            background: var(--rndv-white);
            border-bottom: 1px solid var(--rndv-gray-200);
        }

        
        /* Category Color Indicators */
        .category--pac { border-right: 2px solid #9CA3AF; }
        .category--rapports { border-right: 2px solid #93C5FD; }
        .category--vente { border-right: 2px solid #6EE7B7; }
        .category--billetterie { border-right: 2px solid #FDE68A; }
        .category--pmo { border-right: 2px solid #FDBA74; }
        .category--commercialisation { border-right: 2px solid #A5B4FC; }

        /* Gantt Area */
        .gantt-area {
            flex: 1;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Gantt Header - Sticky */
        .gantt-header {
            position: sticky;
            top: 0;
            z-index: 200;
            background: var(--rndv-white);
        }

        /* Gantt Content - Scrollable */
        .gantt-content {
            flex: 1;
            position: relative;
            min-width: 1400px;
        }

        /* Years Row */
        .years-row {
            display: flex;
            height: var(--header-height);
            background: var(--rndv-primary);
            min-width: 1400px;
        }

        .year-block {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 15px;
            color: var(--rndv-white);
            border-right: 1px solid rgba(255,255,255,0.2);
            letter-spacing: 1px;
        }

        /* Months Row */
        .months-row {
            display: flex;
            height: 38px;
            border-bottom: 1px solid var(--rndv-gray-200);
            background: var(--rndv-gray-50);
            min-width: 1400px;
        }

        .month {
            width: var(--month-width);
            min-width: var(--month-width);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            color: var(--rndv-gray-600);
            border-right: 1px solid var(--rndv-gray-200);
        }

        /* Gantt Rows */
        .gantt-row {
            height: var(--row-height);
            display: flex;
            position: relative;
            background: var(--rndv-white);
            border-bottom: 1px solid var(--rndv-gray-200);
            min-width: 1400px;
        }

        .gantt-row:nth-child(even) {
            background: var(--rndv-gray-50);
        }

        .gantt-cell {
            width: var(--month-width);
            min-width: var(--month-width);
            border-right: 1px solid var(--rndv-gray-100);
        }

        /* ===========================================
           4. TASKS & MILESTONES
           =========================================== */

        /* Task Base Styles */
        .task {
            position: absolute;
            min-height: 28px;
            max-height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: 500;
            padding: 3px 8px;
            cursor: move;
            z-index: 10;
            overflow: hidden;
            user-select: none;
            min-width: 50px;
            box-shadow: var(--shadow-sm);
            transition: box-shadow var(--transition-normal), transform var(--transition-normal);
        }

        .task__name {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-align: center;
            font-size: inherit;
            line-height: 1.2;
            word-break: break-word;
        }

        .task:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
            z-index: 100;
        }

        .task:focus {
            outline: 2px solid var(--rndv-primary);
            outline-offset: 2px;
        }

        /* Task States */
        .task--selected {
            outline: 2px solid var(--rndv-primary);
            outline-offset: 2px;
            z-index: 101;
        }

        .task--dragging {
            opacity: 0.95;
            z-index: 1000;
            box-shadow: 0 12px 32px rgba(70, 48, 234, 0.25);
        }

        /* Task Types - Par cat√©gorie (Pastel) */
        .task--pac {
            background: #9CA3AF;
            color: var(--rndv-white);
        }

        .task--rapports {
            background: #93C5FD;
            color: #1E40AF;
        }

        .task--vente {
            background: #6EE7B7;
            color: #065F46;
        }

        .task--billetterie {
            background: #FDE68A;
            color: #92400E;
        }

        .task--pmo {
            background: #FDBA74;
            color: #9A3412;
        }

        .task--commercialisation {
            background: #A5B4FC;
            color: #3730A3;
        }

        /* Task Delivered Indicator */
        .task--delivered {
            border: 2px solid #10B981 !important;
            box-shadow: var(--shadow-sm);
        }

        /* Task Priority Indicator */
        .task--priority {
            border: 2px solid #DC2626 !important;
            box-shadow: var(--shadow-sm);
        }

        /* Task Types - Variantes (Light) */
        .task--pac-light {
            background: #E5E7EB;
            border: 2px dashed #9CA3AF;
            color: #4B5563;
        }

        .task--rapports-light {
            background: #DBEAFE;
            border: 2px dashed #93C5FD;
            color: #1E40AF;
        }

        .task--vente-light {
            background: #D1FAE5;
            border: 2px dashed #6EE7B7;
            color: #065F46;
        }

        .task--billetterie-light {
            background: #FEF3C7;
            border: 2px dashed #FDE68A;
            color: #92400E;
        }

        .task--pmo-light {
            background: #FFEDD5;
            border: 2px dashed #FDBA74;
            color: #9A3412;
        }

        .task--commercialisation-light {
            background: #E0E7FF;
            border: 2px dashed #A5B4FC;
            color: #3730A3;
        }

        /* Resize Handles */
        .resize-handle {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 8px;
            cursor: ew-resize;
            background: transparent;
            border-radius: 8px;
            transition: background var(--transition-fast);
        }

        .resize-handle:hover {
            background: rgba(70, 48, 234, 0.3);
        }

        .resize-handle--left {
            left: 0;
            border-radius: 8px 0 0 8px;
        }

        .resize-handle--right {
            right: 0;
            border-radius: 0 8px 8px 0;
        }

        /* Milestones Row (in header) */
        .milestones-row {
            height: 80px;
            position: relative;
            background: var(--rndv-gray-50);
            border-bottom: 1px solid var(--rndv-gray-200);
            min-width: 1400px;
            overflow: visible;
        }

        /* Milestone Label */
        .milestone-label {
            position: absolute;
            white-space: nowrap;
            font-size: 10px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 4px;
            z-index: 10;
            transform: translateX(-50%);
        }

        .milestone-label--level-1 {
            top: 4px;
        }

        .milestone-label--level-2 {
            top: 30px;
        }

        .milestone-label--level-3 {
            top: 56px;
        }

        /* Milestone Connector - vertical line from below label through header to content */
        .milestone-connector {
            position: absolute;
            width: 2px;
            transform: translateX(-50%);
            pointer-events: none;
            z-index: 5;
        }

        .milestone-connector--level-1 {
            top: 24px;
            height: 134px;
        }

        .milestone-connector--level-2 {
            top: 50px;
            height: 108px;
        }

        .milestone-connector--level-3 {
            top: 76px;
            height: 82px;
        }

        .milestone-connector--blue { background: rgba(37, 99, 235, 0.25); }
        .milestone-connector--green { background: rgba(0, 217, 165, 0.25); }
        .milestone-connector--red { background: rgba(220, 38, 38, 0.25); }

        .milestone-label--blue {
            background: #EFF6FF;
            color: #1D4ED8;
            border: 1px solid #93C5FD;
        }

        .milestone-label--green {
            background: #D1FAE5;
            color: #065F46;
            border: 1px solid #6EE7B7;
        }

        .milestone-label--red {
            background: #FEF2F2;
            color: #DC2626;
            border: 1px solid #FECACA;
        }

        /* Milestones Lines (in content) - below tasks */
        .milestones-lines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .milestone-line {
            position: absolute;
            top: 0;
            width: 2px;
            height: 100%;
            transform: translateX(-50%);
        }

        .milestone-line--blue { background: rgba(37, 99, 235, 0.25); }
        .milestone-line--green { background: rgba(0, 217, 165, 0.25); }
        .milestone-line--red { background: rgba(220, 38, 38, 0.25); }

        /* ===========================================
           5. UI COMPONENTS
           =========================================== */

        /* Buttons */
        .btn {
            padding: 10px 18px;
            border: 1px solid var(--rndv-gray-300);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            font-family: var(--font-family);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all var(--transition-normal);
        }

        .btn--primary {
            background: var(--rndv-primary);
            color: var(--rndv-white);
            border-color: var(--rndv-primary);
        }

        .btn--primary:hover {
            background: var(--rndv-primary-dark);
            border-color: var(--rndv-primary-dark);
            transform: translateY(-1px);
            box-shadow: var(--shadow-primary);
        }

        .btn--secondary {
            background: var(--rndv-white);
            color: var(--rndv-gray-600);
        }

        .btn--secondary:hover {
            background: var(--rndv-gray-50);
            border-color: var(--rndv-gray-600);
            color: var(--rndv-black);
        }

        .btn--danger {
            background: var(--rndv-white);
            color: var(--rndv-red);
            border-color: var(--rndv-red);
        }

        .btn--danger:hover {
            background: var(--rndv-red);
            color: var(--rndv-white);
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: var(--rndv-black);
            color: var(--rndv-white);
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            max-width: 300px;
            display: none;
            box-shadow: var(--shadow-lg);
        }

        /* Position Indicator */
        .position-indicator {
            position: fixed;
            background: var(--rndv-primary);
            color: var(--rndv-white);
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 500;
            pointer-events: none;
            z-index: 1001;
            display: none;
            box-shadow: var(--shadow-primary);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-overlay--active {
            display: flex;
        }

        .modal {
            background: var(--rndv-white);
            padding: 32px;
            border-radius: 16px;
            min-width: 420px;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .modal__title {
            margin-bottom: 24px;
            font-size: 20px;
            font-weight: 600;
            color: var(--rndv-black);
            border-bottom: 2px solid var(--rndv-primary);
            padding-bottom: 16px;
        }

        .form-group {
            margin-bottom: 18px;
        }

        .form-group__label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 13px;
            color: var(--rndv-gray-600);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .form-group__input,
        .form-group__select {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--rndv-gray-300);
            border-radius: 10px;
            font-size: 14px;
            font-family: var(--font-family);
            transition: all var(--transition-normal);
        }

        .form-group__input:focus,
        .form-group__select:focus {
            outline: none;
            border-color: var(--rndv-primary);
            box-shadow: 0 0 0 3px rgba(70, 48, 234, 0.1);
        }

        .modal__actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 28px;
            padding-top: 20px;
            border-top: 1px solid var(--rndv-gray-200);
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 20px 40px;
            border-top: 1px solid var(--rndv-gray-200);
            background: var(--rndv-white);
        }

        .legend__help {
            color: var(--rndv-gray-600);
            font-size: 12px;
        }

        .legend__items {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 8px;
        }

        .legend__item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 12px;
            color: var(--rndv-gray-600);
        }

        .legend__box {
            width: 28px;
            height: 16px;
            border-radius: 6px;
            box-shadow: var(--shadow-sm);
        }

        .legend__box--pac { background: var(--rndv-gray-600); }
        .legend__box--rapports { background: #3B82F6; }
        .legend__box--vente { background: var(--rndv-green); }
        .legend__box--billetterie { background: var(--rndv-yellow); }
        .legend__box--pmo { background: #F97316; }
        .legend__box--commercialisation { background: var(--rndv-primary); }

        .legend__delivered-icon {
            width: 28px;
            height: 16px;
            background: var(--rndv-gray-200);
            border: 2px solid #10B981;
            border-radius: 6px;
            box-shadow: var(--shadow-sm);
        }

        .legend__priority-icon {
            width: 28px;
            height: 16px;
            background: var(--rndv-gray-200);
            border: 2px solid #DC2626;
            border-radius: 6px;
            box-shadow: var(--shadow-sm);
        }

        .legend__dashed-icon {
            width: 28px;
            height: 16px;
            background: var(--rndv-gray-100);
            border: 2px dashed #9CA3AF;
            border-radius: 6px;
        }

        /* Delivery Summary */
        .delivery-summary {
            padding: 24px 40px;
            border-top: 1px solid var(--rndv-gray-200);
            background: var(--rndv-white);
            border-radius: 0 0 16px 16px;
        }

        .delivery-summary__title {
            font-size: 14px;
            font-weight: 600;
            color: var(--rndv-black);
            margin-bottom: 16px;
        }

        .delivery-summary__sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
        }

        .delivery-summary__section {
            background: var(--rndv-gray-50);
            border-radius: 8px;
            padding: 16px;
        }

        .delivery-summary__section-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            color: var(--rndv-gray-600);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--rndv-gray-200);
        }

        .delivery-summary__section--pac .delivery-summary__section-title { border-bottom-color: #9CA3AF; }
        .delivery-summary__section--rapports .delivery-summary__section-title { border-bottom-color: #93C5FD; }
        .delivery-summary__section--vente .delivery-summary__section-title { border-bottom-color: #6EE7B7; }
        .delivery-summary__section--billetterie .delivery-summary__section-title { border-bottom-color: #FDE68A; }
        .delivery-summary__section--pmo .delivery-summary__section-title { border-bottom-color: #FDBA74; }
        .delivery-summary__section--commercialisation .delivery-summary__section-title { border-bottom-color: #A5B4FC; }

        .delivery-summary__list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .delivery-summary__item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 6px 0;
            font-size: 12px;
            border-bottom: 1px solid var(--rndv-gray-200);
        }

        .delivery-summary__item:last-child {
            border-bottom: none;
        }

        .delivery-summary__task-name {
            color: var(--rndv-black);
            flex: 1;
            padding-right: 12px;
        }

        .delivery-summary__date {
            color: var(--rndv-gray-600);
            font-weight: 500;
            white-space: nowrap;
        }

        /* ===========================================
           6. UTILITIES & STATES
           =========================================== */

        /* Screen Reader Only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus Visible */
        :focus-visible {
            outline: 2px solid var(--rndv-primary);
            outline-offset: 2px;
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="container" role="main">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <img src="Logo_RNDV.png" alt="RNDV Logo" class="logo-img">
                </div>
                <h1 class="header-title">Roadmap billetterie Com√©die-Fran√ßaise</h1>
            </div>
        </header>

        <!-- Toolbar -->
        <nav class="toolbar" role="toolbar" aria-label="Actions du planning">
            <button class="btn btn--primary" onclick="RoadmapApp.save()" aria-label="Sauvegarder le planning">
                <span aria-hidden="true">üíæ</span> Sauvegarder
            </button>
            <button class="btn btn--danger" onclick="RoadmapApp.reset()" aria-label="R√©initialiser le planning">
                <span aria-hidden="true">üîÑ</span> R√©initialiser
            </button>
        </nav>

        <!-- Timeline -->
        <div class="timeline-container" role="region" aria-label="Diagramme de Gantt">
            <!-- Categories Sidebar -->
            <aside class="categories" aria-label="Cat√©gories">
                <div class="category-header" style="height: 158px;"></div>
                <div class="category category--pac">PAC</div>
                <div class="category category--rapports">RAPPORTS</div>
                <div class="category category--vente">VENTE</div>
                <div class="category category--billetterie">GESTION<br>BILLETTERIE</div>
                <div class="category category--pmo">PMO</div>
                <div class="category category--commercialisation">COMMERCIALISATION</div>
            </aside>

            <!-- Gantt Chart -->
            <div class="gantt-area" id="ganttArea" role="grid" aria-label="Planning des t√¢ches">
                <div class="gantt-header">
                    <div class="milestones-row" id="milestonesRow" role="row" aria-label="Jalons"></div>
                    <div class="years-row" id="yearsRow" role="row" aria-label="Ann√©es"></div>
                    <div class="months-row" id="monthsRow" role="row" aria-label="Mois"></div>
                </div>
                <div class="gantt-content" id="ganttContent">
                    <div class="milestones-lines" id="milestonesLines"></div>
                    <div class="gantt-row" id="row-pac" data-row="pac" role="row" aria-label="T√¢ches PAC"></div>
                    <div class="gantt-row" id="row-rapports" data-row="rapports" role="row" aria-label="T√¢ches Rapports"></div>
                    <div class="gantt-row" id="row-vente" data-row="vente" role="row" aria-label="T√¢ches Vente"></div>
                    <div class="gantt-row" id="row-billetterie" data-row="billetterie" role="row" aria-label="T√¢ches Gestion Billetterie"></div>
                    <div class="gantt-row" id="row-pmo" data-row="pmo" role="row" aria-label="T√¢ches PMO"></div>
                    <div class="gantt-row" id="row-commercialisation" data-row="commercialisation" role="row" aria-label="T√¢ches Commercialisation"></div>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <footer class="legend" role="contentinfo">
            <span class="legend__help">
                <span aria-hidden="true">üí°</span>
                Glissez les t√¢ches ‚Ä¢ Tirez les bords pour redimensionner ‚Ä¢ Double-clic pour √©diter
            </span>
            <div class="legend__items">
                <div class="legend__item">
                    <div class="legend__delivered-icon" aria-hidden="true"></div>
                    <span>Livraison maintenue au planning initial</span>
                </div>
                <div class="legend__item">
                    <div class="legend__priority-icon" aria-hidden="true"></div>
                    <span>Livraison prioritaire</span>
                </div>
                <div class="legend__item">
                    <div class="legend__dashed-icon" aria-hidden="true"></div>
                    <span>Planning √† valider post validation des sp√©cifications</span>
                </div>
            </div>
        </footer>

        <!-- Delivery Summary -->
        <section class="delivery-summary" id="deliverySummary">
            <h2 class="delivery-summary__title">R√©capitulatif des dates de livraison</h2>
            <div class="delivery-summary__sections" id="deliverySummarySections">
                <!-- Generated by JavaScript -->
            </div>
        </section>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip" role="tooltip" aria-hidden="true"></div>

    <!-- Position Indicator -->
    <div class="position-indicator" id="positionIndicator" aria-hidden="true"></div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="editModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal">
            <h2 class="modal__title" id="modalTitle">Modifier la t√¢che</h2>
            <div class="form-group">
                <label class="form-group__label" for="editTaskName">Nom de la t√¢che</label>
                <input type="text" id="editTaskName" class="form-group__input" autocomplete="off">
            </div>
            <div class="form-group">
                <label class="form-group__label" for="editTaskInfo">Description</label>
                <input type="text" id="editTaskInfo" class="form-group__input" autocomplete="off">
            </div>
            <div class="form-group">
                <label class="form-group__label" for="editTaskType">Type</label>
                <select id="editTaskType" class="form-group__select">
                    <optgroup label="PAC (Gris)">
                        <option value="pac">PAC - Plein</option>
                        <option value="pac-light">PAC - Light</option>
                    </optgroup>
                    <optgroup label="Rapports (Bleu)">
                        <option value="rapports">Rapports - Plein</option>
                        <option value="rapports-light">Rapports - Light</option>
                    </optgroup>
                    <optgroup label="Vente (Vert)">
                        <option value="vente">Vente - Plein</option>
                        <option value="vente-light">Vente - Light</option>
                    </optgroup>
                    <optgroup label="Billetterie (Jaune)">
                        <option value="billetterie">Billetterie - Plein</option>
                        <option value="billetterie-light">Billetterie - Light</option>
                    </optgroup>
                    <optgroup label="PMO (Orange)">
                        <option value="pmo">PMO - Plein</option>
                        <option value="pmo-light">PMO - Light</option>
                    </optgroup>
                    <optgroup label="Commercialisation (Bleu RNDV)">
                        <option value="commercialisation">Commercialisation - Plein</option>
                        <option value="commercialisation-light">Commercialisation - Light</option>
                    </optgroup>
                </select>
            </div>
            <div class="modal__actions">
                <button class="btn btn--danger" onclick="RoadmapApp.deleteTask()">Supprimer</button>
                <button class="btn btn--secondary" onclick="RoadmapApp.closeModal()">Annuler</button>
                <button class="btn btn--primary" onclick="RoadmapApp.saveTaskEdit()">Sauvegarder</button>
            </div>
        </div>
    </div>

    <script>
    /**
     * RNDV Roadmap Application
     * Interactive Gantt chart for project planning
     *
     * @version 2.0.0
     * @author RNDV Team
     */

    const RoadmapApp = (function() {
        'use strict';

        // ===========================================
        // CONFIGURATION
        // ===========================================

        const CONFIG = {
            MONTH_WIDTH: 100,
            SNAP_GRID: 20,
            MIN_TASK_WIDTH: 40,
            STORAGE_KEY: 'roadmap-tasks',
            MONTHS: [
                { name: 'D√âCEMBRE', year: 2025, index: 0 },
                { name: 'JANVIER', year: 2026, index: 1 },
                { name: 'F√âVRIER', year: 2026, index: 2 },
                { name: 'MARS', year: 2026, index: 3 },
                { name: 'AVRIL', year: 2026, index: 4 },
                { name: 'MAI', year: 2026, index: 5 },
                { name: 'JUIN', year: 2026, index: 6 },
                { name: 'JUILLET', year: 2026, index: 7 },
                { name: 'AO√õT', year: 2026, index: 8 },
                { name: 'SEPTEMBRE', year: 2026, index: 9 },
                { name: 'OCTOBRE', year: 2026, index: 10 },
                { name: 'NOVEMBRE', year: 2026, index: 11 },
                { name: 'D√âCEMBRE', year: 2026, index: 12 },
                { name: 'JANVIER', year: 2027, index: 13 }
            ],
            MONTH_LABELS: ['D√©c 25', 'Jan 26', 'F√©v 26', 'Mar 26', 'Avr 26', 'Mai 26',
                           'Juin 26', 'Juil 26', 'Ao√ªt 26', 'Sep 26', 'Oct 26', 'Nov 26',
                           'D√©c 26', 'Jan 27']
        };

        // ===========================================
        // INITIAL DATA
        // ===========================================

        const INITIAL_TASKS = [
            // PAC (gris) - 2 niveaux centr√©s: 45, 85
            { id: 'task-1', row: 'pac', name: 'Pr√©paration HLM', type: 'pac', left: 10, top: 45, width: 140, info: 'Pr√©paration HLM - D√©cembre √† Janvier' },
            { id: 'task-2', row: 'pac', name: 'Accompagnement HLM', type: 'pac', left: 151, top: 45, width: 584, info: 'Accompagnement HLM - 14 janvier au 11 juillet' },
            { id: 'task-3', row: 'pac', name: 'Pr√©paration et ouverture de saison', type: 'pac', left: 450, top: 85, width: 227, info: 'Pr√©paration et ouverture de saison - Mi-avril au 23 juin' },
            { id: 'task-8', row: 'pac', name: 'Pr√©paration et ouverture de saison', type: 'pac', left: 1150, top: 85, width: 215, info: 'Pr√©paration et ouverture de saison - Mi-novembre 2026 au 20 janvier 2027' },

            // RAPPORTS (bleu) - 2 niveaux centr√©s: 45, 85
            { id: 'task-4', row: 'rapports', name: 'Rapports lot 3', type: 'rapports', left: 5, top: 45, width: 95, info: 'Rapports lot 3 - 1er au 31 d√©cembre 2025', delivered: true },
            { id: 'task-5', row: 'rapports', name: 'Ventilation recettes', type: 'rapports', left: 280, top: 45, width: 120, info: 'Ventilation des recettes - 23 f√©vrier au 1er avril 2026', priority: true },
            { id: 'task-6', row: 'rapports', name: 'Factur-X (Chorus pro)', type: 'rapports', left: 440, top: 45, width: 220, info: 'Factur-X niveau minimum (Chorus pro) - 13 avril au 19 juin 2026', priority: true },
            { id: 'task-7', row: 'rapports', name: 'Conformit√© comptable', type: 'rapports', left: 5, top: 85, width: 290, info: 'Rapports et conformit√© comptable - Structure des rapports et correction probl√®mes d√©j√† identifi√©s - 1er d√©cembre 2025 au 27 f√©vrier 2026', priority: true },

            // VENTE (vert) - 4 niveaux centr√©s: 5, 45, 85, 125
            { id: 'task-9', row: 'vente', name: 'Exports PDF', type: 'vente', left: 5, top: 5, width: 95, info: 'Gestion exports PDF - 1er au 31 d√©cembre 2025', delivered: true },
            { id: 'task-12', row: 'vente', name: 'Optimisation BOCA', type: 'vente', left: 5, top: 45, width: 252, info: 'Optimisation BOCA - 1er d√©cembre 2025 au 16 f√©vrier 2026' },
            { id: 'task-10', row: 'vente', name: 'Landing promo', type: 'vente', left: 303, top: 5, width: 164, info: 'Landing offre promo - 2 mars au 20 avril 2026', priority: true },
            { id: 'task-13', row: 'vente', name: 'Caisse rapide', type: 'vente', left: 405, top: 45, width: 258, info: 'Caisse rapide - 1er avril au 19 juin 2026' },
            { id: 'task-11', row: 'vente', name: 'Autonomie param.', type: 'vente', left: 555, top: 5, width: 145, info: 'Autonomie param√©trage - 18 mai au 30 juin 2026', priority: true },
            { id: 'task-14', row: 'vente', name: 'Package prestations', type: 'vente-light', left: 400, top: 85, width: 150, info: 'Package et prestations dat√©es' },
            { id: 'task-15', row: 'vente', name: 'Ventes crois√©es L1', type: 'vente-light', left: 500, top: 125, width: 140, info: 'Ventes crois√©es et m√©thodes de livraison LOT 1 (TBC)' },
            { id: 'task-16', row: 'vente', name: 'Ventes crois√©es L2', type: 'vente-light', left: 650, top: 125, width: 140, info: 'Ventes crois√©es et m√©thodes de livraison LOT 2 (TBC)' },

            // GESTION BILLETTERIE (jaune) - 4 niveaux centr√©s: 5, 45, 85, 125
            { id: 'task-17', row: 'billetterie', name: '√âcran client caisse', type: 'billetterie-light', left: 700, top: 5, width: 150, info: '√âcran client caisse' },
            { id: 'task-18', row: 'billetterie', name: 'Permissions op√©rateurs', type: 'billetterie-light', left: 800, top: 45, width: 170, info: 'Permissions fines des op√©rateurs' },
            { id: 'task-19', row: 'billetterie', name: 'Liste d\'attente', type: 'billetterie-light', left: 800, top: 85, width: 120, info: 'Liste d\'attente' },
            { id: 'task-20', row: 'billetterie', name: 'Pr√©p. Interface revendeurs', type: 'billetterie-light', left: 400, top: 125, width: 180, info: 'Pr√©paration Interface revendeurs (Contractualisation CF faite avec les revendeurs d√©finis, ateliers techniques r√©alis√©s)' },
            { id: 'task-21', row: 'billetterie', name: 'Interface revendeurs', type: 'billetterie-light', left: 800, top: 125, width: 150, info: 'Interface revendeurs' },

            // PMO (orange) - 3 niveaux centr√©s: 25, 65, 105
            { id: 'task-22', row: 'pmo', name: 'Pr√©pa ateliers', type: 'pmo', left: 10, top: 25, width: 110, info: 'Pr√©paration ateliers de sp√©cification fonctionnelle' },
            { id: 'task-23', row: 'pmo', name: 'Ateliers sp√©cif.', type: 'pmo', left: 130, top: 25, width: 120, info: 'Ateliers de sp√©cifications fonctionnelles' },
            { id: 'task-24', row: 'pmo', name: 'R√©daction sp√©cif.', type: 'pmo', left: 130, top: 65, width: 140, info: 'R√©daction sp√©cifications' },
            { id: 'task-25', row: 'pmo', name: 'Cadrage doc.', type: 'pmo', left: 130, top: 105, width: 110, info: 'Cadrage documentaire RNDV' },
            { id: 'task-26', row: 'pmo', name: 'Manuel RNDV', type: 'pmo', left: 250, top: 105, width: 120, info: 'R√©daction MANUEL RNDV' },

            // COMMERCIALISATION (bleu RNDV) - 3 niveaux centr√©s: 25, 65, 105
            { id: 'task-27', row: 'commercialisation', name: 'Cadrage PITCH', type: 'commercialisation', left: 10, top: 25, width: 120, info: 'Cadrage PITCH RNDV' },
            { id: 'task-28', row: 'commercialisation', name: 'R√©daction PITCH', type: 'commercialisation', left: 140, top: 25, width: 130, info: 'R√©daction PITCH RNDV' },
            { id: 'task-29', row: 'commercialisation', name: 'Contact revendeurs', type: 'commercialisation', left: 280, top: 25, width: 140, info: 'Contact revendeurs' },
            { id: 'task-30', row: 'commercialisation', name: 'Prospects HLM', type: 'commercialisation', left: 10, top: 65, width: 120, info: 'Rencontre prospects HLM' },
            { id: 'task-31', row: 'commercialisation', name: 'Follow UP BIS/MC', type: 'commercialisation', left: 140, top: 65, width: 130, info: 'Follow UP BIS / MC' },
            { id: 'task-32', row: 'commercialisation', name: 'SaaS RNDV One', type: 'commercialisation', left: 280, top: 65, width: 120, info: 'Cadrage plateforme SaaS RNDV One' },
            { id: 'task-33', row: 'commercialisation', name: 'Newsletter RNDV', type: 'commercialisation', left: 10, top: 105, width: 140, info: 'Cadrage Newsletter RNDV' }
        ];

        const MILESTONES = [
            { date: '21/01', label: 'BIS Nantes', position: 170, color: 'blue', level: 1 },
            { date: '27/02', label: 'Go Prod', position: 290, color: 'blue', level: 2 },
            { date: '21/03', label: 'PUBLICS XP', position: 370, color: 'green', level: 3 },
            { date: '26/03', label: 'SITEM', position: 430, color: 'green', level: 1 }
        ];

        // ===========================================
        // STATE
        // ===========================================

        let state = {
            tasks: [],
            selectedTask: null,
            editingTask: null,
            isDragging: false,
            isResizing: false,
            resizeDirection: null,
            dragStartX: 0,
            taskStartLeft: 0,
            taskStartWidth: 0,
            currentFilter: 'all',
            currentOffset: 0
        };

        // ===========================================
        // DOM ELEMENTS
        // ===========================================

        const elements = {};

        function cacheElements() {
            elements.tooltip = document.getElementById('tooltip');
            elements.positionIndicator = document.getElementById('positionIndicator');
            elements.editModal = document.getElementById('editModal');
            elements.ganttArea = document.getElementById('ganttArea');
            elements.ganttContent = document.getElementById('ganttContent');
            elements.milestonesRow = document.getElementById('milestonesRow');
            elements.milestonesLines = document.getElementById('milestonesLines');
            elements.yearsRow = document.getElementById('yearsRow');
            elements.monthsRow = document.getElementById('monthsRow');
            elements.editTaskName = document.getElementById('editTaskName');
            elements.editTaskInfo = document.getElementById('editTaskInfo');
            elements.editTaskType = document.getElementById('editTaskType');
            elements.deliverySummarySections = document.getElementById('deliverySummarySections');
        }

        // ===========================================
        // RENDERING
        // ===========================================

        function renderTimeline(year = 'all') {
            state.currentFilter = year;
            const months = CONFIG.MONTHS;
            state.currentOffset = 0;

            // Render years
            elements.yearsRow.innerHTML = `
                <div class="year-block" style="width: 100px;">2025</div>
                <div class="year-block" style="width: 1200px;">2026</div>
                <div class="year-block" style="width: 100px;">2027</div>
            `;

            // Render months
            elements.monthsRow.innerHTML = months
                .map(month => `<div class="month">${month.name}</div>`)
                .join('');

            // Render gantt cells
            const rows = ['pac', 'rapports', 'vente', 'billetterie', 'pmo', 'commercialisation'];
            rows.forEach(rowName => {
                const row = document.querySelector(`[data-row="${rowName}"]`);
                row.querySelectorAll('.gantt-cell').forEach(cell => cell.remove());

                months.forEach(() => {
                    const cell = document.createElement('div');
                    cell.className = 'gantt-cell';
                    row.insertBefore(cell, row.firstChild);
                });
            });

            renderTasks();
            renderMilestones();
        }

        function renderTasks() {
            document.querySelectorAll('.task').forEach(el => el.remove());

            state.tasks.forEach(task => {
                const row = document.querySelector(`[data-row="${task.row}"]`);
                if (!row) return;

                const taskEl = document.createElement('div');
                taskEl.className = `task task--${task.type}${task.delivered ? ' task--delivered' : ''}${task.priority ? ' task--priority' : ''}`;
                taskEl.id = task.id;
                taskEl.style.cssText = `left: ${task.left}px; top: ${task.top}px; width: ${task.width}px;`;
                taskEl.setAttribute('role', 'gridcell');
                taskEl.setAttribute('tabindex', '0');
                taskEl.setAttribute('aria-label', `${task.name}: ${task.info}`);
                taskEl.innerHTML = `
                    <div class="resize-handle resize-handle--left" aria-hidden="true"></div>
                    <span class="task__name">${task.name}</span>
                    <div class="resize-handle resize-handle--right" aria-hidden="true"></div>
                `;

                // Event listeners
                taskEl.addEventListener('mousedown', e => handleTaskMouseDown(e, task));
                taskEl.addEventListener('dblclick', () => openEditModal(task));
                taskEl.addEventListener('mouseenter', e => showTooltip(e, task));
                taskEl.addEventListener('mouseleave', hideTooltip);
                taskEl.addEventListener('keydown', e => handleTaskKeydown(e, task));

                row.appendChild(taskEl);
            });
        }

        function renderMilestones() {
            elements.milestonesRow.innerHTML = '';
            elements.milestonesLines.innerHTML = '';

            // Render milestone labels (in header), connectors (through header), and lines (in content)
            MILESTONES.forEach(milestone => {
                const adjustedPos = milestone.position - state.currentOffset;
                if (adjustedPos < -50 || adjustedPos > 1500) return;

                // Label in header with level positioning
                const label = document.createElement('div');
                label.className = `milestone-label milestone-label--${milestone.color} milestone-label--level-${milestone.level}`;
                label.style.left = `${adjustedPos}px`;
                label.textContent = `${milestone.date} - ${milestone.label}`;
                elements.milestonesRow.appendChild(label);

                // Connector from below label through years and months rows
                const connector = document.createElement('div');
                connector.className = `milestone-connector milestone-connector--${milestone.color} milestone-connector--level-${milestone.level}`;
                connector.style.left = `${adjustedPos}px`;
                elements.milestonesRow.appendChild(connector);

                // Line in content
                const line = document.createElement('div');
                line.className = `milestone-line milestone-line--${milestone.color}`;
                line.style.left = `${adjustedPos}px`;
                elements.milestonesLines.appendChild(line);
            });

            // Render Mises en Vente milestone
            const mevPosition = 680 - state.currentOffset;
            if (mevPosition >= -100 && mevPosition < 1500) {
                // Label (level 1 - far from others)
                const mevLabel = document.createElement('div');
                mevLabel.className = 'milestone-label milestone-label--red milestone-label--level-1';
                mevLabel.style.left = `${mevPosition}px`;
                mevLabel.textContent = '23-30/06 - MEV 26-27';
                elements.milestonesRow.appendChild(mevLabel);

                // Connector
                const mevConnector = document.createElement('div');
                mevConnector.className = 'milestone-connector milestone-connector--red milestone-connector--level-1';
                mevConnector.style.left = `${mevPosition}px`;
                elements.milestonesRow.appendChild(mevConnector);

                // Line
                const mevLine = document.createElement('div');
                mevLine.className = 'milestone-line milestone-line--red';
                mevLine.style.left = `${mevPosition}px`;
                elements.milestonesLines.appendChild(mevLine);
            }
        }

        function renderDeliverySummary() {
            const categories = {
                pac: { name: 'PAC', tasks: [] },
                rapports: { name: 'RAPPORTS', tasks: [] },
                vente: { name: 'VENTE', tasks: [] },
                billetterie: { name: 'GESTION BILLETTERIE', tasks: [] },
                pmo: { name: 'PMO', tasks: [] },
                commercialisation: { name: 'COMMERCIALISATION', tasks: [] }
            };

            // Group tasks by category and calculate end dates
            state.tasks.forEach(task => {
                const endPosition = task.left + task.width;
                const endDate = positionToDate(endPosition);
                categories[task.row].tasks.push({
                    name: task.name,
                    endDate: endDate,
                    endPosition: endPosition
                });
            });

            // Sort tasks by end date within each category
            Object.values(categories).forEach(cat => {
                cat.tasks.sort((a, b) => a.endPosition - b.endPosition);
            });

            // Generate HTML
            let html = '';
            Object.entries(categories).forEach(([key, cat]) => {
                if (cat.tasks.length === 0) return;

                html += `
                    <div class="delivery-summary__section delivery-summary__section--${key}">
                        <h3 class="delivery-summary__section-title">${cat.name}</h3>
                        <ul class="delivery-summary__list">
                            ${cat.tasks.map(task => `
                                <li class="delivery-summary__item">
                                    <span class="delivery-summary__task-name">${task.name}</span>
                                    <span class="delivery-summary__date">${task.endDate}</span>
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                `;
            });

            elements.deliverySummarySections.innerHTML = html;
        }

        function positionToDate(position) {
            // Timeline starts December 2025, each month = 100px
            const monthIndex = Math.floor(position / CONFIG.MONTH_WIDTH);
            const dayInMonth = Math.round((position % CONFIG.MONTH_WIDTH) / CONFIG.MONTH_WIDTH * 30);

            // Months array starting from December 2025
            const months = [
                { month: 12, year: 2025, name: 'D√©c' },
                { month: 1, year: 2026, name: 'Jan' },
                { month: 2, year: 2026, name: 'F√©v' },
                { month: 3, year: 2026, name: 'Mar' },
                { month: 4, year: 2026, name: 'Avr' },
                { month: 5, year: 2026, name: 'Mai' },
                { month: 6, year: 2026, name: 'Juin' },
                { month: 7, year: 2026, name: 'Juil' },
                { month: 8, year: 2026, name: 'Ao√ªt' },
                { month: 9, year: 2026, name: 'Sep' },
                { month: 10, year: 2026, name: 'Oct' },
                { month: 11, year: 2026, name: 'Nov' },
                { month: 12, year: 2026, name: 'D√©c' },
                { month: 1, year: 2027, name: 'Jan' }
            ];

            const monthData = months[Math.min(monthIndex, months.length - 1)];
            const day = Math.max(1, Math.min(dayInMonth + 1, 30));

            return `${day} ${monthData.name} ${monthData.year}`;
        }

        // ===========================================
        // TASK INTERACTIONS
        // ===========================================

        function handleTaskMouseDown(e, task) {
            const isResizeHandle = e.target.classList.contains('resize-handle');

            if (isResizeHandle) {
                state.isResizing = true;
                state.resizeDirection = e.target.classList.contains('resize-handle--left') ? 'left' : 'right';
            } else {
                state.isDragging = true;
            }

            state.editingTask = task;
            state.dragStartX = e.clientX;
            state.taskStartLeft = task.left;
            state.taskStartWidth = task.width;

            // Update selection
            document.querySelectorAll('.task').forEach(t => t.classList.remove('task--selected'));
            document.getElementById(task.id)?.classList.add('task--selected');
            state.selectedTask = task;

            e.preventDefault();
        }

        function handleMouseMove(e) {
            if (!state.editingTask) return;

            const deltaX = e.clientX - state.dragStartX;
            const taskEl = document.getElementById(state.editingTask.id);
            if (!taskEl) return;

            if (state.isDragging) {
                let newLeft = Math.max(0, state.taskStartLeft + deltaX);
                newLeft = Math.round(newLeft / CONFIG.SNAP_GRID) * CONFIG.SNAP_GRID;

                state.editingTask.left = newLeft;
                taskEl.style.left = `${newLeft}px`;
                taskEl.classList.add('task--dragging');

                showPositionIndicator(e, newLeft, state.editingTask.width);
            } else if (state.isResizing) {
                taskEl.classList.add('task--dragging');

                if (state.resizeDirection === 'right') {
                    let newWidth = Math.max(CONFIG.MIN_TASK_WIDTH, state.taskStartWidth + deltaX);
                    newWidth = Math.round(newWidth / CONFIG.SNAP_GRID) * CONFIG.SNAP_GRID;

                    state.editingTask.width = newWidth;
                    taskEl.style.width = `${newWidth}px`;
                } else {
                    let newLeft = state.taskStartLeft + deltaX;
                    let newWidth = state.taskStartWidth - deltaX;

                    if (newWidth >= CONFIG.MIN_TASK_WIDTH) {
                        newLeft = Math.round(newLeft / CONFIG.SNAP_GRID) * CONFIG.SNAP_GRID;
                        newWidth = state.taskStartWidth - (newLeft - state.taskStartLeft);

                        state.editingTask.left = newLeft;
                        state.editingTask.width = newWidth;
                        taskEl.style.left = `${newLeft}px`;
                        taskEl.style.width = `${newWidth}px`;
                    }
                }

                showPositionIndicator(e, state.editingTask.left, state.editingTask.width);
            }
        }

        function handleMouseUp() {
            if (state.editingTask) {
                const taskEl = document.getElementById(state.editingTask.id);
                taskEl?.classList.remove('task--dragging');
            }

            // Update summary if task was moved or resized
            if (state.isDragging || state.isResizing) {
                renderDeliverySummary();
            }

            state.isDragging = false;
            state.isResizing = false;
            state.editingTask = null;
            elements.positionIndicator.style.display = 'none';
        }

        function handleTaskKeydown(e, task) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                openEditModal(task);
            }
        }

        // ===========================================
        // UI HELPERS
        // ===========================================

        function showTooltip(e, task) {
            if (state.isDragging || state.isResizing) return;

            elements.tooltip.textContent = task.info;
            elements.tooltip.style.display = 'block';
            elements.tooltip.style.left = `${e.clientX + 15}px`;
            elements.tooltip.style.top = `${e.clientY + 15}px`;
        }

        function hideTooltip() {
            elements.tooltip.style.display = 'none';
        }

        function showPositionIndicator(e, left, width) {
            const startMonth = Math.floor(left / CONFIG.MONTH_WIDTH);
            const duration = (width / CONFIG.MONTH_WIDTH).toFixed(1);
            const monthName = CONFIG.MONTH_LABELS[startMonth] || 'D√©c 25';

            elements.positionIndicator.innerHTML = `D√©but: ${monthName} | Dur√©e: ${duration} mois`;
            elements.positionIndicator.style.display = 'block';
            elements.positionIndicator.style.left = `${e.clientX + 15}px`;
            elements.positionIndicator.style.top = `${e.clientY - 30}px`;
        }

        // ===========================================
        // MODAL
        // ===========================================

        function openEditModal(task) {
            state.editingTask = task;
            elements.editTaskName.value = task.name;
            elements.editTaskInfo.value = task.info;
            elements.editTaskType.value = task.type;
            elements.editModal.classList.add('modal-overlay--active');
            elements.editTaskName.focus();
        }

        function closeModal() {
            elements.editModal.classList.remove('modal-overlay--active');
            state.editingTask = null;
        }

        function saveTaskEdit() {
            if (!state.editingTask) return;

            state.editingTask.name = elements.editTaskName.value;
            state.editingTask.info = elements.editTaskInfo.value;
            state.editingTask.type = elements.editTaskType.value;

            renderTasks();
            renderDeliverySummary();
            closeModal();
        }

        function deleteTask() {
            if (!state.editingTask) return;

            if (confirm('Supprimer cette t√¢che ?')) {
                state.tasks = state.tasks.filter(t => t.id !== state.editingTask.id);
                renderTasks();
                renderDeliverySummary();
                closeModal();
            }
        }

        // ===========================================
        // STORAGE
        // ===========================================

        function save() {
            try {
                localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(state.tasks));
                alert('Sauvegard√© !');
            } catch (error) {
                console.error('Erreur de sauvegarde:', error);
                alert('Erreur lors de la sauvegarde');
            }
        }

        function load() {
            try {
                const saved = localStorage.getItem(CONFIG.STORAGE_KEY);
                if (saved) {
                    state.tasks = JSON.parse(saved);
                    return true;
                }
            } catch (error) {
                console.error('Erreur de chargement:', error);
            }
            return false;
        }

        function reset() {
            if (confirm('R√©initialiser toutes les positions ?')) {
                state.tasks = JSON.parse(JSON.stringify(INITIAL_TASKS));
                localStorage.removeItem(CONFIG.STORAGE_KEY);
                renderTimeline(state.currentFilter);
                renderDeliverySummary();
            }
        }

        // ===========================================
        // INITIALIZATION
        // ===========================================

        function init() {
            cacheElements();

            // Load saved data or use initial
            if (!load()) {
                state.tasks = JSON.parse(JSON.stringify(INITIAL_TASKS));
            }

            // Global event listeners
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', handleMouseUp);

            document.addEventListener('keydown', e => {
                if (e.key === 'Escape') closeModal();
            });

            elements.editModal.addEventListener('click', e => {
                if (e.target === elements.editModal) closeModal();
            });

            // Render
            renderTimeline('all');
            renderDeliverySummary();
        }

        // ===========================================
        // PUBLIC API
        // ===========================================

        return {
            init,
            save,
            reset,
            closeModal,
            saveTaskEdit,
            deleteTask
        };
    })();

    // Initialize on DOM ready
    document.addEventListener('DOMContentLoaded', RoadmapApp.init);
    </script>
</body>
</html>
